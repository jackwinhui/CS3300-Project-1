<html>

<head>
	<script src="https://d3js.org/d3.v7.min.js"></script>
	<style>
		.gridlines line {
			stroke: grey;
		}

		.gridlines .domain {
			stroke: none;
		}

		.title {
			font-style: bold;
			font-size: 40px;
			font-family: "Copperplate", fantasy;
		}

		.subtitle {
			font-style: bold;
			font-size: 25px;
			font-family: "Copperplate", fantasy;
		}


		.small {
			font-size: 25px;
			font-family: "Copperplate", fantasy;
		}

		svg {
			background-size: 1200px 800px;
			background: linear-gradient(rgba(0, 0, 0, 0.6), rgba(0, 0, 0, 0.6)), url('./marvel.png');
		}

		label {
			font-color: white;
		}
	</style>
</head>
<svg id = "graph1" height=800 width=1200 style="border:1px solid black">
	<defs>
		//i1
				<pattern id="i1" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/iron-man.png" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i2
				<pattern id="i2" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/hulk.png" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i3
				<pattern id="i3" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/iron-man.png" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i4
				<pattern id="i4" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/thor.png" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i5
				<pattern id="i5" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/cap-am.jpeg" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i6
				<pattern id="i6" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/avengers.jpeg" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i7
				<pattern id="i7" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/iron-man.png" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i8
				<pattern id="i8" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/thor.png" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i9
				<pattern id="i9" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/cap-am.jpeg" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i10
				<pattern id="i10" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/guardians.png" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i11
				<pattern id="i11" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/avengers.jpeg" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i12
				<pattern id="i12" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/ant-man.png" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i13
				<pattern id="i13" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/cap-am.jpeg" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i14
				<pattern id="i14" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/dr-strange.jpeg" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i15
				<pattern id="i15" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/guardians.png" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i16
				<pattern id="i16" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/spiderman.png" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i17
				<pattern id="i17" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/thor.png" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i18
				<pattern id="i18" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/black-panther.jpeg" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i19
				<pattern id="i19" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/avengers.jpeg" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i20
				<pattern id="i20" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/ant-man.png" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i21
				<pattern id="i21" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/cap-marvel.jpeg" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i22
				<pattern id="i22" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/avengers.jpeg" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i23
				<pattern id="i23" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/spiderman.png" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i24
				<pattern id="i24" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/black-widow.png" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i25
				<pattern id="i25" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/shang-chi.png" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i26
				<pattern id="i26" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/eternals.jpeg" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i27
				<pattern id="i27" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/spiderman.png" width="1" height="1" preserveAspectRatio="none"> </image>
		</pattern>
</defs>
</svg>
<p id = "graph1">
<script>
	const svg = d3.select("svg#graph1");
	const width = svg.attr("width");
	const height = svg.attr("height");
	const margin = { top: 150, right: 100, bottom: 100, left: 150 };
	const chartWidth = width - margin.left - margin.right;
	const chartHeight = height - margin.top - margin.bottom;
	let annotations = svg.append("g").attr("id", "annotations");
	let chartArea = svg.append("g").attr("id", "points")
		.attr("transform", `translate(${margin.left},${margin.top})`);

	d3.csv("./mcu_box_office.csv", d3.autoType).then(
		(data) => {
			console.log(data)
			const timeParser = d3.timeParse('%m/%d/%Y'); //m/d/yyyy
			data.forEach(d => { d['worldwide_box_office'] = Number(parseFloat(d['worldwide_box_office'].replace(/,/g, ''))); });
			data.forEach(d => { d['production_budget'] = Number(parseFloat(d['production_budget'].replace(/,/g, ''))); });
			data.forEach(d => { d['release_date'] = timeParser(d['release_date']); });

			//x-axis with Date
			const dateExtent = d3.extent(data, d => d['release_date']);
			const dateScale = d3.scaleTime()
				.domain(dateExtent)
				.range([0, chartWidth]);
			let bottomAxis = d3.axisBottom(dateScale);
			annotations.append("g")
				.attr("class", "x axis")
				.attr("transform", `translate(${margin.left},${chartHeight + margin.top + 10})`)
				.style("color", "white")
				.call(bottomAxis);

			//y-axis with boxOffice - productionBudget
			const boxOfficeExtent = d3.extent(data, d => (d['worldwide_box_office'] - d['production_budget']) / 1000000);
			const boxOfficeScale = d3.scaleLinear().domain(boxOfficeExtent).range([chartHeight, 0]);
			let leftAxis = d3.axisLeft(boxOfficeScale);
			annotations.append("g")
				.attr("class", "y axis")
				.attr("transform", `translate(${margin.left - 10},${margin.top})`)
				.style("color", "white")
				.call(leftAxis);

			//y-axis gridlines
			let leftGridlines = d3.axisLeft(boxOfficeScale).tickSize(-chartWidth - 10).tickFormat("");
			annotations.append('g')
				.attr("class", "gridlines")
				.attr("transform", `translate(${margin.left - 10}, ${margin.top})`)
				.call(leftGridlines);

			//x-axis gridlines
			let bottomGridlines = d3.axisBottom(dateScale).tickSize(-chartHeight - 10).tickFormat("");
			annotations.append('g')
				.attr("class", "gridlines")
				.attr("transform", `translate(${margin.left}, ${chartHeight + margin.top + 10})`)
				.call(bottomGridlines);

			//title
			annotations.append("text")
				.attr("class", "title")
				.attr("text-anchor", "middle")
				.attr("x", margin.left + chartWidth / 2)
				.attr("y", margin.top - 60)
				.text("MARVEL CINEMATIC UNIVERSE")
				.attr("fill", "white");

			//subtitle
			annotations.append("text")
				.attr("class", "subtitle")
				.attr("text-anchor", "middle")
				.attr("x", margin.left + chartWidth / 2)
				.attr("y", margin.top - 30)
				.text("PROFIT PER MOVIE OVER THE YEARS")
				.attr("fill", "white");

			//x-axis label
			annotations.append("text")
				.attr("class", "small")
				.attr("text-anchor", "middle")
				.attr("x", margin.left + chartWidth / 2)
				.attr("y", margin.top + chartHeight + 70)
				.text("Date (Year)")
				.attr("fill", "grey")
				.attr("font-size", "100")
				.attr("font", "100px serif");

			//y-axis label
			annotations.append("text")
				.attr("class", "small")
				.attr("transform", "rotate(270)")
				.attr("text-anchor", "middle")
				.attr("x", -chartHeight / 2 - margin.top)
				.attr("y", margin.left / 2 - 10)
				.text("Worldwide Box Office-Profit")
				.attr("fill", "grey")
				.attr("font-size", "32");

			//y-axis label
			annotations.append("text")
				.attr("class", "small")
				.attr("transform", "rotate(270)")
				.attr("text-anchor", "middle")
				.attr("x", -chartHeight / 2 - margin.top)
				.attr("y", margin.left / 2 + 10)
				.text("(Millions)")
				.attr("fill", "grey")
				.attr("font-size", "32");

			//data line
			var lineGen = d3.line()
				.x(d => dateScale(d.release_date))
				.y(d => boxOfficeScale((d['worldwide_box_office'] - d['production_budget']) / 1000000));
			chartArea.append("path")
				.datum(data)
				.attr("class", "line")
				.attr("fill", "none")
				.attr("stroke", "white")
				.attr("stroke-width", 6)
				.attr("d", lineGen);

			//data points
				svg.selectAll("circle")
				  .data(data)
				  .join("circle")
				  .attr("cx", d => dateScale(d["release_date"]))
				  .attr("cy", d => boxOfficeScale((d["worldwide_box_office"] - d["production_budget"]) / 1000000))
				  .attr("r", 15)
				  .attr("transform", `translate(${margin.left},${margin.top})`);

			// add images to data points
			let i = 1;
			(svg.selectAll("circle")._groups[0]).forEach( d => {
						d.setAttribute("fill", "url(#i" + i + ")");
					i ++;
					});

			//interactive hover
			let mouseGroup = chartArea.append("g");
			let xMarker = mouseGroup.append("line")
				.attr("id", "xMarker")
				.attr("fill", "none")
				.attr("stroke", "white")
				.attr("stroke-width", 1)
				.attr("y1", 0)
				.attr("y2", chartHeight + 20)
				.attr("visibility", "hidden");
			let valueMarker = mouseGroup.append("circle")
				.attr("id", "valueMarker")
				.attr("stroke", "white")
				.attr("stroke-width", 2)
				.attr("r", 10)
				.attr("visibility", "hidden");
			let label = mouseGroup.append("text")
				.attr("id", "label")
				.attr("visibility", "")
				.attr("class", "label");
			let activeRegion = mouseGroup.append("rect")
				.attr("id", "activeRegion")
				.attr("width", chartWidth + 100)
				.attr("height", chartHeight + 100)
				.attr("fill", "none")
				.attr("pointer-events", "all");
			activeRegion.on("mouseover", function () {
				xMarker.attr("visibility", "");
				valueMarker.attr("visibility", "");
				label.attr("visibility", "");
			});
			activeRegion.on("mouseout", function () {
				xMarker.attr("visibility", "hidden");
				valueMarker.attr("visibility", "hidden");
				label.attr("visibility", "hidden");
			});
			let findDate = d3.bisector(d => d.release_date).right;
			activeRegion.on("mousemove", function (evt) {
				let location = d3.pointer(evt);
				let x = location[0];
				let xDate = dateScale.invert(x);
				let index = findDate(data, xDate);
				let d = data[index];
				let xPos = dateScale(d['release_date']);
				let yPos = boxOfficeScale((d['worldwide_box_office'] - d['production_budget']) / 1000000);
				xMarker.attr("x1", xPos).attr("x2", xPos);
				valueMarker.attr("cx", xPos).attr("cy", yPos);
				let txt = d['movie_title']
				label.text(txt)
				label.attr("x", xPos).attr("y", yPos - 30).attr("text-anchor", "end").attr("hidden", "").attr("fill", "white");
			});
		})
</script>
</p>

<svg id = "graph2" height=800 width=1200 style="border:1px solid black">
	<defs>
		//i1
				<pattern id="i1" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/iron-man.png" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i2
				<pattern id="i2" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/hulk.png" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i3
				<pattern id="i3" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/iron-man.png" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i4
				<pattern id="i4" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/thor.png" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i5
				<pattern id="i5" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/cap-am.jpeg" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i6
				<pattern id="i6" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/avengers.jpeg" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i7
				<pattern id="i7" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/iron-man.png" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i8
				<pattern id="i8" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/thor.png" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i9
				<pattern id="i9" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/cap-am.jpeg" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i10
				<pattern id="i10" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/guardians.png" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i11
				<pattern id="i11" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/avengers.jpeg" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i12
				<pattern id="i12" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/ant-man.png" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i13
				<pattern id="i13" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/cap-am.jpeg" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i14
				<pattern id="i14" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/dr-strange.jpeg" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i15
				<pattern id="i15" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/guardians.png" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i16
				<pattern id="i16" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/spiderman.png" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i17
				<pattern id="i17" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/thor.png" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i18
				<pattern id="i18" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/black-panther.jpeg" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i19
				<pattern id="i19" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/avengers.jpeg" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i20
				<pattern id="i20" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/ant-man.png" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i21
				<pattern id="i21" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/cap-marvel.jpeg" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i22
				<pattern id="i22" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/avengers.jpeg" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i23
				<pattern id="i23" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/spiderman.png" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i24
				<pattern id="i24" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/black-widow.png" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i25
				<pattern id="i25" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/shang-chi.png" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i26
				<pattern id="i26" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/eternals.jpeg" width="1" height="1" preserveAspectRatio="none"> </image>
				</pattern>
				//i27
				<pattern id="i27" patternContentUnits="objectBoundingBox" width="100%" height="100%">
					<image xlink:href="./logos/spiderman.png" width="1" height="1" preserveAspectRatio="none"> </image>
		</pattern>
</defs>
</svg>
<p id = "graph2">
<script>
	const svg2 = d3.select("svg#graph2");
	const width2 = svg2.attr("width");
	const height2 = svg2.attr("height");
	const margin2 = { top: 150, right: 100, bottom: 100, left: 150 };
	const chartWidth2 = width2 - margin2.left - margin2.right;
	const chartHeight2 = height2 - margin2.top - margin2.bottom;
	let annotations2 = svg2.append("g").attr("id", "annotations");
	let chartArea2 = svg2.append("g").attr("id", "points")
		.attr("transform", `translate(${margin2.left},${margin2.top})`);

	d3.csv("./mcu_box_office.csv", d3.autoType).then(
		(data) => {
			console.log(data)
			const timeParser = d3.timeParse('%m/%d/%Y'); //m/d/yyyy
			data.forEach(d => { d['worldwide_box_office'] = Number(parseFloat(d['worldwide_box_office'].replace(/,/g, ''))); });
			data.forEach(d => { d['production_budget'] = Number(parseFloat(d['production_budget'].replace(/,/g, ''))); });
			data.forEach(d => { d['release_date'] = timeParser(d['release_date']); });

			//x-axis with Date
			const dateExtent2 = d3.extent(data, d => d['release_date']);
			const dateScale2 = d3.scaleTime()
				.domain(dateExtent2)
				.range([0, chartWidth2]);
			let bottomAxis2 = d3.axisBottom(dateScale2);
			annotations2.append("g")
				.attr("class", "x axis")
				.attr("transform", `translate(${margin2.left},${chartHeight2 + margin2.top + 10})`)
				.style("color", "white")
				.call(bottomAxis2);

			//y-axis with boxOffice / productionBudget in %
			const boxOfficeExtent2 = d3.extent(data, d => (d['worldwide_box_office'] / d['production_budget']));
			const boxOfficeScale2 = d3.scaleLinear().domain(boxOfficeExtent2).range([chartHeight2, 0]);
			let leftAxis2 = d3.axisLeft(boxOfficeScale2).tickFormat(d3.format('.0%'));
			annotations2.append("g")
				.attr("class", "y axis")
				.attr("transform", `translate(${margin2.left - 10},${margin2.top})`)
				.style("color", "white")
				.call(leftAxis2);

			//y-axis gridlines
			let leftGridlines2 = d3.axisLeft(boxOfficeScale2).tickSize(-chartWidth2 - 10).tickFormat("");
			annotations2.append('g')
				.attr("class", "gridlines")
				.attr("transform", `translate(${margin2.left - 10}, ${margin2.top})`)
				.call(leftGridlines2);

			//x-axis gridlines
			let bottomGridlines2 = d3.axisBottom(dateScale2).tickSize(-chartHeight2 - 10).tickFormat("");
			annotations2.append('g')
				.attr("class", "gridlines")
				.attr("transform", `translate(${margin2.left}, ${chartHeight2 + margin2.top + 10})`)
				.call(bottomGridlines2);

			//title
			annotations2.append("text")
				.attr("class", "title")
				.attr("text-anchor", "middle")
				.attr("x", margin2.left + chartWidth2 / 2)
				.attr("y", margin2.top - 60)
				.text("MARVEL CINEMATIC UNIVERSE")
				.attr("fill", "white");

			//subtitle
			annotations2.append("text")
				.attr("class", "subtitle")
				.attr("text-anchor", "middle")
				.attr("x", margin2.left + chartWidth2 / 2)
				.attr("y", margin2.top - 30)
				.text("RETURN ON INVESTMENT PER MOVIE OVER THE YEARS")
				.attr("fill", "white");

			//x-axis label
			annotations2.append("text")
				.attr("class", "small")
				.attr("text-anchor", "middle")
				.attr("x", margin2.left + chartWidth2 / 2)
				.attr("y", margin2.top + chartHeight2 + 70)
				.text("Date (Year)")
				.attr("fill", "grey")
				.attr("font-size", "100")
				.attr("font", "100px serif");

			//y-axis label
			annotations2.append("text")
				.attr("class", "small")
				.attr("transform", "rotate(270)")
				.attr("text-anchor", "middle")
				.attr("x", -chartHeight2 / 2 - margin2.top)
				.attr("y", margin2.left / 2 - 10)
				.text("Worldwide Return on Investment")
				.attr("fill", "grey")
				.attr("font-size", "32");

			//y-axis label
			annotations2.append("text")
				.attr("class", "small")
				.attr("transform", "rotate(270)")
				.attr("text-anchor", "middle")
				.attr("x", -chartHeight2 / 2 - margin2.top)
				.attr("y", margin2.left / 2 + 10)
				.text("Worldwide Box Office Sales to Production Budget Ratio")
				.attr("fill", "grey")
				.attr("font-size", "32");

			//data line
			var lineGen2 = d3.line()
				.x(d => dateScale2(d.release_date))
				.y(d => boxOfficeScale2((d['worldwide_box_office'] / d['production_budget'])));
			chartArea2.append("path")
				.datum(data)
				.attr("class", "line")
				.attr("fill", "none")
				.attr("stroke", "white")
				.attr("stroke-width", 6)
				.attr("d", lineGen2);

			//data points
			svg2.selectAll("circle")
				  .data(data)
				  .join("circle")
				  .attr("cx", d => dateScale2(d["release_date"]))
				  .attr("cy", d => boxOfficeScale2((d["worldwide_box_office"] / d["production_budget"])))
				  .attr("r", 15)
				  .attr("transform", `translate(${margin2.left},${margin2.top})`);

			// add images to data points
			let i = 1;
			(svg2.selectAll("circle")._groups[0]).forEach( d => {
						d.setAttribute("fill", "url(#i" + i + ")");
					i ++;
					});
					//interactive hover
					let mouseGroup2 = chartArea2.append("g");
					let xMarker2 = mouseGroup2.append("line")
						.attr("id", "xMarker")
						.attr("fill", "none")
						.attr("stroke", "white")
						.attr("stroke-width", 1)
						.attr("y1", 0)
						.attr("y2", chartHeight2 + 20)
						.attr("visibility", "hidden");
					let valueMarker2 = mouseGroup2.append("circle")
						.attr("id", "valueMarker")
						.attr("stroke", "white")
						.attr("stroke-width", 2)
						.attr("r", 10)
						.attr("visibility", "hidden");
					let label2 = mouseGroup2.append("text")
						.attr("id", "label")
						.attr("visibility", "")
						.attr("class", "label");
					let activeRegion2 = mouseGroup2.append("rect")
						.attr("id", "activeRegion")
						.attr("width", chartWidth2 + 100)
						.attr("height", chartHeight2 + 100)
						.attr("fill", "none")
						.attr("pointer-events", "all");
					activeRegion2.on("mouseover", function () {
						xMarker2.attr("visibility", "");
						valueMarker2.attr("visibility", "");
						label2.attr("visibility", "");
					});
					activeRegion2.on("mouseout", function () {
						xMarker2.attr("visibility", "hidden");
						valueMarker2.attr("visibility", "hidden");
						label2.attr("visibility", "hidden");
					});
					let findDate2 = d3.bisector(d => d.release_date).right;
					activeRegion2.on("mousemove", function (evt) {
						let location2 = d3.pointer(evt);
						let x2 = location[0];
						let xDate2 = dateScale2.invert(x2);
						let index2 = findDate2(data, xDate2);
						let d = data[index2];
						let xPos2 = dateScale2(d['release_date']);
						let yPos2 = boxOfficeScale2((d['worldwide_box_office'] / d['production_budget']));
						xMarker2.attr("x1", xPos2).attr("x2", xPos2);
						valueMarker2.attr("cx", xPos2).attr("cy", yPos2);
						let txt2 = d['movie_title']
						label.text(txt2)
						label.attr("x", xPos2).attr("y", yPos2 - 30).attr("text-anchor", "end").attr("hidden", "").attr("fill", "white");
					});
		})
</script>
</p>

<svg id = "graph3" height=800 width=1200 style="border:1px solid black">
	<defs>
		//i1
		<pattern id="i1" patternContentUnits="objectBoundingBox" width="100%" height="100%">
			<image xlink:href="./logos/iron-man.png" width="1" height="1" preserveAspectRatio="none"> </image>
		</pattern>
		//i2
		<pattern id="i2" patternContentUnits="objectBoundingBox" width="100%" height="100%">
			<image xlink:href="./logos/hulk.png" width="1" height="1" preserveAspectRatio="none"> </image>
		</pattern>
		//i3
		<pattern id="i3" patternContentUnits="objectBoundingBox" width="100%" height="100%">
			<image xlink:href="./logos/iron-man.png" width="1" height="1" preserveAspectRatio="none"> </image>
		</pattern>
		//i4
		<pattern id="i4" patternContentUnits="objectBoundingBox" width="100%" height="100%">
			<image xlink:href="./logos/thor.png" width="1" height="1" preserveAspectRatio="none"> </image>
		</pattern>
		//i5
		<pattern id="i5" patternContentUnits="objectBoundingBox" width="100%" height="100%">
			<image xlink:href="./logos/cap-am.jpeg" width="1" height="1" preserveAspectRatio="none"> </image>
		</pattern>
		//i6
		<pattern id="i6" patternContentUnits="objectBoundingBox" width="100%" height="100%">
			<image xlink:href="./logos/avengers.jpeg" width="1" height="1" preserveAspectRatio="none"> </image>
		</pattern>
		//i7
		<pattern id="i7" patternContentUnits="objectBoundingBox" width="100%" height="100%">
			<image xlink:href="./logos/iron-man.png" width="1" height="1" preserveAspectRatio="none"> </image>
		</pattern>
		//i8
		<pattern id="i8" patternContentUnits="objectBoundingBox" width="100%" height="100%">
			<image xlink:href="./logos/thor.png" width="1" height="1" preserveAspectRatio="none"> </image>
		</pattern>
		//i9
		<pattern id="i9" patternContentUnits="objectBoundingBox" width="100%" height="100%">
			<image xlink:href="./logos/cap-am.jpeg" width="1" height="1" preserveAspectRatio="none"> </image>
		</pattern>
		//i10
		<pattern id="i10" patternContentUnits="objectBoundingBox" width="100%" height="100%">
			<image xlink:href="./logos/guardians.png" width="1" height="1" preserveAspectRatio="none"> </image>
		</pattern>
		//i11
		<pattern id="i11" patternContentUnits="objectBoundingBox" width="100%" height="100%">
			<image xlink:href="./logos/avengers.jpeg" width="1" height="1" preserveAspectRatio="none"> </image>
		</pattern>
		//i12
		<pattern id="i12" patternContentUnits="objectBoundingBox" width="100%" height="100%">
			<image xlink:href="./logos/ant-man.png" width="1" height="1" preserveAspectRatio="none"> </image>
		</pattern>
		//i13
		<pattern id="i13" patternContentUnits="objectBoundingBox" width="100%" height="100%">
			<image xlink:href="./logos/cap-am.jpeg" width="1" height="1" preserveAspectRatio="none"> </image>
		</pattern>
		//i14
		<pattern id="i14" patternContentUnits="objectBoundingBox" width="100%" height="100%">
			<image xlink:href="./logos/dr-strange.jpeg" width="1" height="1" preserveAspectRatio="none"> </image>
		</pattern>
		//i15
		<pattern id="i15" patternContentUnits="objectBoundingBox" width="100%" height="100%">
			<image xlink:href="./logos/guardians.png" width="1" height="1" preserveAspectRatio="none"> </image>
		</pattern>
		//i16
		<pattern id="i16" patternContentUnits="objectBoundingBox" width="100%" height="100%">
			<image xlink:href="./logos/spiderman.png" width="1" height="1" preserveAspectRatio="none"> </image>
		</pattern>
		//i17
		<pattern id="i17" patternContentUnits="objectBoundingBox" width="100%" height="100%">
			<image xlink:href="./logos/thor.png" width="1" height="1" preserveAspectRatio="none"> </image>
		</pattern>
		//i18
		<pattern id="i18" patternContentUnits="objectBoundingBox" width="100%" height="100%">
			<image xlink:href="./logos/black-panther.jpeg" width="1" height="1" preserveAspectRatio="none"> </image>
		</pattern>
		//i19
		<pattern id="i19" patternContentUnits="objectBoundingBox" width="100%" height="100%">
			<image xlink:href="./logos/avengers.jpeg" width="1" height="1" preserveAspectRatio="none"> </image>
		</pattern>
		//i20
		<pattern id="i20" patternContentUnits="objectBoundingBox" width="100%" height="100%">
			<image xlink:href="./logos/ant-man.png" width="1" height="1" preserveAspectRatio="none"> </image>
		</pattern>
		//i21
		<pattern id="i21" patternContentUnits="objectBoundingBox" width="100%" height="100%">
			<image xlink:href="./logos/cap-marvel.jpeg" width="1" height="1" preserveAspectRatio="none"> </image>
		</pattern>
		//i22
		<pattern id="i22" patternContentUnits="objectBoundingBox" width="100%" height="100%">
			<image xlink:href="./logos/avengers.jpeg" width="1" height="1" preserveAspectRatio="none"> </image>
		</pattern>
		//i23
		<pattern id="i23" patternContentUnits="objectBoundingBox" width="100%" height="100%">
			<image xlink:href="./logos/spiderman.png" width="1" height="1" preserveAspectRatio="none"> </image>
		</pattern>
		//i24
		<pattern id="i24" patternContentUnits="objectBoundingBox" width="100%" height="100%">
			<image xlink:href="./logos/black-widow.png" width="1" height="1" preserveAspectRatio="none"> </image>
		</pattern>
		//i25
		<pattern id="i25" patternContentUnits="objectBoundingBox" width="100%" height="100%">
			<image xlink:href="./logos/shang-chi.png" width="1" height="1" preserveAspectRatio="none"> </image>
		</pattern>
		//i26
		<pattern id="i26" patternContentUnits="objectBoundingBox" width="100%" height="100%">
			<image xlink:href="./logos/eternals.jpeg" width="1" height="1" preserveAspectRatio="none"> </image>
		</pattern>
		//i27
		<pattern id="i27" patternContentUnits="objectBoundingBox" width="100%" height="100%">
			<image xlink:href="./logos/spiderman.png" width="1" height="1" preserveAspectRatio="none"> </image>
		</pattern>
</defs>
</svg>
<p id = "graph3">
<script>
	const svg3 = d3.select("svg#graph3");
	const width3 = svg3.attr("width");
	const height3 = svg3.attr("height");
	const margin3 = { top: 100, right: 100, bottom: 190, left: 150 };
	const chartWidth3 = width3 - margin3.left - margin3.right;
	const chartHeight3 = height3 - margin3.top - margin3.bottom;
	let annotations3 = svg3.append("g").attr("id", "annotations");
	let chartArea3 = svg3.append("g").attr("id", "points")
		.attr("transform", `translate(${margin3.left},${margin3.top})`);

	d3.csv("./mcu_box_office.csv", d3.autoType).then(
		(data) => {

			//x-axis with movie title
			const movies = d3.map(data, d => d.movie_title)
			const movieScale = d3.scaleBand().domain(movies).range([0, chartWidth3]);
			let bottomAxis3 = d3.axisBottom(movieScale);
			annotations3.append("g")
				.attr("class", "x axis")
				.attr("transform", `translate(${margin3.left},${chartHeight3 + margin3.top + 10})`)
				.style("color", "white")
				.call(bottomAxis3);
				svg3.selectAll("text")
					 .attr("y", 0)
				   .attr("x", 10)
					 .attr("dy", ".35em")
					 .attr("transform", "rotate(60)")
					 .attr("text-anchor", "start");

			//y-axis with tomato_meter and audience score
			const scoreExtent = d3.extent(data, d=>(d.tomato_meter+d.audience_score)/2);
			const avgScore = d3.mean(data,d=>(d.tomato_meter+d.audience_score)/2);
			const dist = Math.max(Math.abs(scoreExtent[0]-avgScore),Math.abs(scoreExtent[1]-avgScore));
			const adjustedExtent = [avgScore-dist,avgScore+dist]
			console.log(adjustedExtent)
			const scoreScale = d3.scaleLinear().domain(adjustedExtent).range([chartHeight,0]);
			let leftAxis3 = d3.axisLeft(scoreScale);
			annotations3.append("g")
				.attr("class", "y axis")
				.attr("transform", `translate(${margin3.left - 10},${margin3.top-50})`)
				.style("color", "white")
				.call(leftAxis3);

			//y-axis gridlines
			let leftGridlines3 = d3.axisLeft(scoreScale).tickSize(-chartWidth3 - 10).tickFormat("");
			annotations3.append('g')
				.attr("class", "gridlines")
				.attr("transform", `translate(${margin3.left - 10}, ${margin3.top-50})`)
				.call(leftGridlines3);

			//title
			annotations3.append("text")
				.attr("class", "title")
				.attr("text-anchor", "middle")
				.attr("x", margin3.left + chartWidth3 / 2)
				.attr("y", margin3.top - 42)
				.text("MARVEL CINEMATIC UNIVERSE")
				.attr("fill", "white");

			//subtitle
			annotations3.append("text")
				.attr("class", "subtitle")
				.attr("text-anchor", "middle")
				.attr("x", margin3.left + chartWidth3 / 2)
				.attr("y", margin3.top - 17)
				.text("AVERAGE OF TOMATO METER AND AUDIENCE SCORE")
				.attr("fill", "white");

			//x-axis label
			annotations3.append("text")
				.attr("class", "small")
				.attr("text-anchor", "middle")
				.attr("x", margin3.left + chartWidth3 / 2)
				.attr("y", chartHeight3+ margin3.top + margin3.bottom - 25)
				.text("MOVIE TITLE")
				.attr("fill", "grey")
				.attr("font-size", "100")
				.attr("font", "100px serif");

			//y-axis label
			annotations3.append("text")
				.attr("class", "small")
				.attr("transform", "rotate(270)")
				.attr("text-anchor", "middle")
				.attr("x", -chartHeight3 / 2 - margin3.top)
				.attr("y", margin3.left / 2)
				.text("AVERAGE SCORE")
				.attr("fill", "grey")
				.attr("font-size", "32");

			 chartArea3.append("line")
						 .attr("x1", -10)
						 .attr("x2", chartWidth3+10)
						 .attr("y1", scoreScale(avgScore)-50 )
						 .attr("y2", scoreScale(avgScore)-50 )
						.style("stroke-width", 2)
						.style("stroke", "white")
						.style("stroke-dasharray", ("5, 5"));
		 lollipops = chartArea3.selectAll('g.lollipop').data(data,d=>d3.mean([d["tomato_meter"],d["audience_score"]]))
		 						.join('g')
		 						.attr('class','lollipop')
		 lollipops.append("line")
		 		.attr("class","stick")
		 		.attr("x1",45)
		 		.attr("x2",45)
		 		.attr("y1",scoreScale(avgScore)-50)
		 		.attr("y2",d=>scoreScale(d3.mean([d["tomato_meter"],d["audience_score"]]))-50)

		 svg3.selectAll("circle")
			   .data(data)
			   .join("circle")
			   .attr("cx", d => movieScale(d["movie_title"])+20)
			   .attr("cy", d => scoreScale(d3.mean([d["tomato_meter"],d["audience_score"]]))-50)
			   .attr("r", 15)
			   .attr("fill", "white")
			   .attr("transform", `translate(${margin3.left},${margin3.top})`);

			 // add images to data points
			 let i = 1;
			 		(svg3.selectAll("circle")._groups[0]).forEach( d => {
			 			d.setAttribute("fill", "url(#i" + i + ")");
			 		i ++;
			 		});

			});
</script>
</p>

</html>
